@model UserRoles.ViewModels.OrgTreeNodeViewModel

@{
    var currentRole = (ViewBag.CurrentRole as string) ?? "User";
}

<!-- ================= ORG NODE ================= -->
<div class="org-box submanager org-node"
     data-id="@Model.User.Id"
     data-role="SubManager"
     draggable="true"
     ondragstart="drag(event)"
     ondragover="allowDrop(event)"
     ondrop="drop(event,'@Model.User.Id')">

    <div class="node-actions-top above-name">
        @if (currentRole == "Admin")
        {
            <a onclick="openEditModal('@Model.User.Id','@Model.User.FirstName','@Model.User.Email','SubManager')">✏️</a>
            <a onclick="openDeleteModal('@Model.User.Id','@Model.User.FirstName','SubManager')">🗑</a>
        }

        @if (currentRole == "Admin")
        {
            <a href="javascript:void(0)" onclick="loadReports('@Model.User.Id')">📊</a>
        }
    </div>

    <!-- NAME -->
    <div class="node-title">
        @Model.User.FirstName
    </div>
</div>

<!-- ================= CHILDREN ================= -->
@if (Model.Children.Any())
{
    <div class="org-children">
        @foreach (var child in Model.Children)
        {
            @Html.Partial("_OrgTreeNode", child)
        }
    </div>
}