@model UserRoles.ViewModels.AddReportPanelViewModel

<div id="addReportFormContainer" class="card mt-3">
    <div class="card-body">

        <!-- ================= SECURITY ================= -->
        @Html.AntiForgeryToken()

        <!-- ================= REQUIRED HIDDEN ================= -->
        <input type="hidden" id="targetUserId" name="targetUserId" value="@Model.TargetUserId" />
        <input type="hidden" id="reportDate" name="date" value="@Model.Date" />

        <!-- ================= DATE (TEXT ONLY) ================= -->
        <div class="mb-2">
            <label class="form-label fw-semibold">Date</label>
            <div class="form-control-plaintext">@Model.Date</div>
        </div>

        <!-- ================= TASK ================= -->
        <div class="mb-2">
            <label class="form-label">Task</label>
            <textarea id="taskInput"
                      name="task"
                      class="form-control char-limit"
                      rows="2"
                      maxlength="100"
                      data-counter="taskCounter"
                      required></textarea>
            <small id="taskCounter" class="text-muted">
                100 characters remaining
            </small>
        </div>

        <!-- ================= NOTE ================= -->
        <div class="mb-2">
            <label class="form-label">Note</label>
            <textarea id="noteInput"
                      name="note"
                      class="form-control char-limit"
                      rows="2"
                      maxlength="100"
                      data-counter="noteCounter"
                      required></textarea>
            <small id="noteCounter" class="text-muted">
                100 characters remaining
            </small>
        </div>

        <!-- ================= REPORTED TO ================= -->
        <!-- Update the REPORTED TO section in _AddReportPanel.cshtml: -->
        <!-- ================= REPORTED TO ================= -->
        <div class="mb-3">
            <label class="form-label">Reported To</label><br />

            <!-- ✅ ADDED: Error message -->
            <div class="text-danger small mb-1 d-none" id="addReportPanelError">
                Please select Admin or Manager.
            </div>

            <label>
                <input type="checkbox" name="reportedTo" value="Admin" class="add-panel-checkbox" checked /> Admin
            </label>
            <label class="ms-3">
                <input type="checkbox" name="reportedTo" value="Manager" class="add-panel-checkbox" /> Manager
            </label>
        </div>

        <!-- ================= ACTIONS ================= -->
        <button type="button"
                class="btn btn-success"
                id="submitReportBtn">
            Submit Report
        </button>

        <button type="button"
                class="btn btn-secondary ms-2"
                onclick="loadReports('@Model.TargetUserId')">
            Cancel
        </button>

    </div>
</div>

<!-- ================= CHARACTER COUNTER ================= -->
<script>
    document.addEventListener("input", function (e) {

        if (!e.target.classList.contains("char-limit")) return;

        const counter = document.getElementById(e.target.dataset.counter);
        if (!counter) return;

        counter.textContent =
            (100 - e.target.value.length) + " characters remaining";
    });
</script>

